<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    package="com.example.autolaunchtechstern">
<!-- Boot and system permissions -->
    <uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
<uses-permission android:name="android.permission.QUICKBOOT_POWERON" />
<uses-permission android:name="android.permission.SYSTEM_ALERT_WINDOW" />
<uses-permission android:name="android.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS" />
<uses-permission android:name="android.permission.WAKE_LOCK" />
<uses-permission android:name="android.permission.FOREGROUND_SERVICE" />
<uses-permission android:name="android.permission.GET_TASKS" />
<uses-permission android:name="android.permission.REORDER_TASKS" />
<uses-permission android:name="android.permission.INTERNET" />
<!-- For Android 10+ auto-start -->
<uses-permission android:name="android.permission.FOREGROUND_SERVICE_SPECIAL_USE" />
<application
    android:allowBackup="false"
    android:dataExtractionRules="@xml/data_extraction_rules"
    android:foregroundServiceType="mediaPlayback"
    android:fullBackupContent="@xml/backup_rules"
    android:icon="@drawable/techstern_logo"
    android:label="@string/app_name"
    android:roundIcon="@mipmap/ic_launcher_round"
    android:supportsRtl="true"
    android:exported="true"
    android:theme="@style/Theme.AutolaunchTechstern"
    android:enableOnBackInvokedCallback="true"
    android:usesCleartextTraffic="true"
    tools:targetApi="31"
    tools:ignore="UnusedAttribute">
    <!-- Main Activity -->
    <activity
        android:name=".ui.MainActivity"
        android:exported="true"
        android:launchMode="singleTask"
        android:screenOrientation="fullSensor">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
            <category android:name="android.intent.category.HOME" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <!-- Settings Activity -->
    <activity
        android:name=".ui.SettingsActivity"
        android:exported="false" />
    <!-- Boot Receiver - CRITICAL -->
    <receiver
        android:name=".ui.BootReceiver"
        android:enabled="true"
        android:exported="true"
        android:priority="1000">
        <intent-filter android:priority="1000">
            <action android:name="android.intent.action.BOOT_COMPLETED" />
            <action android:name="android.intent.action.LOCKED_BOOT_COMPLETED" />
            <action android:name="android.intent.action.QUICKBOOT_POWERON" />
            <action android:name="com.htc.intent.action.QUICKBOOT_POWERON" />
            <action android:name="android.intent.action.REBOOT" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </receiver>
    <!-- Device Admin Receiver -->
    <receiver
        android:name=".ui.helper.MyDeviceAdminReceiver"
        android:exported="true"
        android:permission="android.permission.BIND_DEVICE_ADMIN">
        <meta-data
            android:name="android.app.device_admin"
            android:resource="@xml/device_admin" />
        <intent-filter>
            <action android:name="android.app.action.DEVICE_ADMIN_ENABLED" />
        </intent-filter>
    </receiver>
    <!-- Kiosk Service -->
    <service
        android:name=".ui.KioskService"
        android:enabled="true"
        android:exported="false"
        android:foregroundServiceType="specialUse">
        <property
            android:name="android.app.PROPERTY_SPECIAL_USE_FGS_SUBTYPE"
            android:value="kiosk" />
    </service>
    <!-- Auto Launch Service -->
    <service
        android:name=".ui.AutoLaunchService"
        android:enabled="true"
        android:exported="false"
        android:foregroundServiceType="specialUse">
        <property
            android:name="android.app.PROPERTY_SPECIAL_USE_FGS_SUBTYPE"
            android:value="autolaunch" />
    </service>
    <!-- Job Service for delayed start -->
    <service
        android:name=".ui.BootJobService"
        android:enabled="true"
        android:exported="false"
        android:permission="android.permission.BIND_JOB_SERVICE" />
    <!-- Accessibility Service -->
    <service
        android:name=".ui.AutoLaunchAccessibilityService"
        android:enabled="true"
        android:exported="false"
        android:permission="android.permission.BIND_ACCESSIBILITY_SERVICE">
        <intent-filter>
            <action android:name="android.accessibilityservice.AccessibilityService" />
        </intent-filter>
        <meta-data
            android:name="android.accessibilityservice"
            android:resource="@xml/accessibility_service_config" />
    </service>
    <service
        android:name=".ui.helper.InactivityMonitorService"
        android:enabled="true"
        android:exported="false" />
</application>
</manifest>